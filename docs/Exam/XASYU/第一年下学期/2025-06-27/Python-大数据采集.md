# Python 大数据采集

1. 大数据思维方式的主要特点，根据材料 (连锁超市、共享单车等) 分析，说明：运营商如何获取用户数据？符合大数据的哪些特征？

    - **大数据思维方式的主要特点：**
      - 全量数据而非抽样数据：关注所有数据，而不仅仅是部分数据。
      - 关注效率而非精确：允许一定程度的误差，以换取更快的处理速度和结果。
      - 关联关系而非因果关系：更关注数据之间的关联，而不是试图找到明确的因果关系。
      - 预测性分析：通过分析历史数据，预测未来的趋势或行为。

    - **结合材料 (连锁超市、共享单车等) 分析：**
      - **运营商如何获取用户数据？**
        - **连锁超市：** 会员卡注册信息，POS 机销售记录，APP 使用行为，线上购物数据，用户调研，监控摄像头数据（到店行为）。
        - **共享单车：** APP 注册信息，GPS 定位数据（骑行轨迹、起止点），支付信息，扫码开锁记录，用户反馈。
      - **符合大数据的哪些特征？（5V 特征 / 3V 特征）**
        - **Volume (数据量大):** 海量用户数据，交易记录，地理位置信息等。
        - **Velocity (速度快):** 数据产生和更新速度快，需要实时处理和分析。
        - **Variety (类型多):** 结构化数据（交易记录），非结构化数据（用户评论，图片），半结构化数据（APP 日志）。
        - **Veracity (真实性):** 数据质量参差不齐，需要清洗和验证。
        - **Value (价值高):** 通过分析可以获得有价值的商业洞察。
        - **3V 特征，Volume，Velocity，Variety
        - **根据材料选择 3V 或 5V，不要全写**

2. 大数据分析用户到店行为，需采集哪些数据？如何实现数据可视化？

    - **需采集的数据：**
      - 用户 ID，时间戳，地理位置（经纬度），停留时长，浏览商品类别，购买商品，支付方式，是否使用优惠券，店内 WiFi 连接记录，店内摄像头监控数据等。
    - **如何实现数据可视化？（文字描述）**
      1. **数据准备：** 清洗、转换采集到的数据，确保数据格式统一和准确。
      2. **确定可视化目标：** 例如，分析不同时段的客流量，不同区域的顾客偏好，等等。
      3. **选择合适的图表类型：** 如柱状图（客流量变化），热力图（顾客偏好），地图（顾客分布）。
      4. **使用可视化工具：** 如 Tableau, Power BI, Python 的 Matplotlib, Seaborn。
      5. **创建图表：** 将数据导入工具，选择图表类型，设置坐标轴，添加标签和标题。
      6. **交互和分析：** 通过交互式图表，深入分析数据，发现潜在的模式和趋势。

3. 简述大数据特征（大数据的 5V 特征、3V 特征），并对比传统数据分析的局限性。

    - **大数据 5V 特征：**
      - Volume：海量数据
      - Velocity：高速产生和处理
      - Variety：多样性数据类型
      - Veracity：数据真实性
      - Value：数据价值
    - **大数据 3V 特征：**
      - Volume：海量数据
      - Velocity：高速产生和处理
      - Variety：多样性数据类型
    - **传统数据分析的局限性：**
      - 数据量小：无法处理海量数据。
      - 处理速度慢：无法实时处理高速产生的数据。
      - 数据类型单一：主要处理结构化数据。
      - 数据质量高：要求数据非常干净和准确。
      - 价值发现有限：难以发现隐藏在海量复杂数据中的价值。

4. （共享单车运营商）应用大数据技术过程中将会面临哪些挑战？

    - **数据安全：** 用户隐私数据泄露风险，数据被恶意攻击。
    - **数据质量：** GPS 数据漂移，用户乱停乱放，数据缺失。
    - **技术挑战：** 海量数据存储和处理，实时数据分析，算法优化。
    - **业务挑战：** 车辆调度，用户行为预测，市场竞争。
    - **成本问题：** 存储，计算，带宽的成本。

5. 脏数据的处理方法，空值、缺失值如何处理？（具体介绍每种方法）

    p 99

    - **脏数据：** 缺失值、异常值、重复值、不一致的数据。
    - **空值、缺失值如何处理？(p99)**
      1. **删除：**  删除包含缺失值的记录或字段（适用于缺失值比例很小的情况）。
      2. **填充：**  使用均值、中位数、众数、固定值、或模型预测值填充缺失值。
      3. **忽略：**  在某些情况下，可以忽略缺失值，让算法自行处理。
          - **具体介绍每种方法**

6. 缺失值可以用那几种填充方法（列举：均值、中位数和众数填充法），并说明存在的潜在问题（如均值填充时）?

    p 177

    - **列举：均值、中位数和众数填充法**
      - **均值填充：** 使用该列的平均值填充缺失值。
      - **中位数填充：** 使用该列的中位数填充缺失值。
      - **众数填充：** 使用该列的众数（出现次数最多的值）填充缺失值。
    - **说明存在的潜在问题（如均值填充时）?**
      - 均值填充会改变数据的分布，可能导致结果不准确。例如作业缺失用平均成绩补全，会造成没有交作业的同学拿到不合理的成绩。

7. 异常值处理：发现某字段（如用户名、手机号）存在部分全为空格的记录，从数据收集和使用的角度，分析这些记录产生的原因，如何处理这类数据？

    p 183

    - **发现某字段（如用户名、手机号）存在部分全为空格的记录，从数据收集和使用的角度，分析这些记录产生的原因，如何处理这类数据？**
      - **原因分析：**
        - **数据收集：** 用户输入错误、程序 bug、数据传输错误。
          - **数据使用：** 系统验证不严格，导致非法数据进入数据库。
      - **处理方法：**
        1. **删除：**  如果空格记录比例很小，且对分析影响不大，可以直接删除。
        2. **填充：**  如果可以推断出正确的值，可以进行填充（例如，根据其他信息推断出手机号）。
        3. **标记：**  将空格记录标记为特殊值，方便后续处理。

8. 每天产生的数据量约 10GB，使用 Excel 存储骑行数据是否合理？存在主要问题和可能带来的影响。

    p 126

    - **是否合理？**
      - 不合理。Excel 存储能力有限，处理大数据效率低。
    - **存在主要问题和可能带来的影响。**
      - **数据量限制：** Excel 只能处理有限行的数据，超过限制会报错。
      - **处理速度慢：** 打开、保存、筛选大数据文件速度慢。
      - **格式限制：** Excel 对数据格式有一定要求，不适合存储复杂数据。
      - **协作困难：** 多人同时编辑同一个 Excel 文件容易出错。

9. 对骑行数据进行预处理时，通常需要经历哪些步骤？每个步骤的目的是什么？

    - **步骤：**
      1. **数据清洗：**  处理缺失值、异常值、重复值。
      2. **数据转换：**  数据类型转换，单位转换，格式转换。
      3. **数据集成：**  将来自不同数据源的数据合并到一起。
      4. **数据归约：**  降低数据维度，减少数据量。
    - **目的：**
      - 提高数据质量，确保数据准确性和一致性。
      - 使数据更适合分析，提高分析效率和准确性。

10. 费用字段存在大量缺失值，请设计一套完整的处理方案，含缺失值产生原因分析、处理方法选择及具体操作步骤，并使用 Python 实现。

    p 100

    - **设计一套完整的处理方案，含缺失值产生原因分析、处理方法选择及具体操作步骤，并使用 Python 实现。**
      1. **缺失值产生原因分析：**
          - 系统 bug，用户未填写，数据传输错误。
      2. **处理方法选择：**
          - 如果缺失比例较小，可以使用均值或中位数填充。
          - 如果缺失比例较大，可以使用模型预测值填充。
      3. **具体操作步骤：**
          - (1) 分析缺失值比例。
          - (2) 选择填充方法。
          - (3) 使用 Python 代码实现填充。
      4. **Python 实现：**

    ```python
    import pandas as pd
    import numpy as np

    # 读取数据
    df = pd.read_csv('your_data.csv')

    # 查看缺失值比例
    print(df['费用'].isnull().sum() / len(df))

    # 使用均值填充
    df['费用'].fillna(df['费用'].mean(), inplace=True)

    # 使用中位数填充
    # df['费用'].fillna(df['费用'].median(), inplace=True)

    # 使用模型预测值填充（示例：线性回归）
    # from sklearn.linear_model import LinearRegression
    # model = LinearRegression()
    # model.fit(df[['特征1', '特征2']], df['费用'])
    # df['费用'].fillna(model.predict(df[['特征1', '特征2']]), inplace=True)

    # 查看填充后的缺失值数量
    print(df['费用'].isnull().sum())

    # 保存处理后的数据
    # df.to_csv('processed_data.csv', index=False)
    ```

11. 会用 python 语言编写程序，处理空值、缺失值、异常值。

    - **如：根据给定数据集，找出百分制成绩（score）字段中小于 0 或大于 100 的异常数据，并将这些异常数据的学习时长设置为缺失值（NaN），最后输出处理后的数据。**

    ```python
    import pandas as pd
    import numpy as np

    # 创建示例数据
    data = {'score': [80, 90, -10, 110, 75, 0, 100],
            'study_time': [10, 12, 0, 15, 8, 2, 14]}
    df = pd.DataFrame(data)

    # 找到异常数据
    abnormal_data = df[(df['score'] < 0) | (df['score'] > 100)]

    # 将异常数据的学习时长设置为缺失值
    df.loc[abnormal_data.index, 'study_time'] = np.nan

    # 输出处理后的数据
    print(df)
    ```

12. 设计可视化流程？可视化工具（特点）

    p 212

    1. **数据准备：** 清洗、转换、整理数据。
    2. **确定可视化目标：**  明确要展示的信息和要回答的问题。
    3. **选择合适的图表类型：**  根据数据类型和目标选择图表。
    4. **设计图表：**  设置坐标轴、颜色、标签等。
    5. **实现可视化：**  使用可视化工具创建图表。
    6. **评估和优化：**  检查图表是否清晰、易懂，根据需要进行优化。

    - **可视化工具（特点）**
      - **Matplotlib:** Python 库，灵活，可定制性强，适合生成静态图表。
      - **Seaborn:** 基于 Matplotlib，提供更高级的统计图表，美观易用。
      - **Plotly:** 交互式可视化库，可以创建动态图表，支持在线分享。
      - **Tableau:** 商业 BI 工具，强大易用，适合数据探索和仪表盘制作。
      - **Power BI:** 微软 BI 工具，与 Excel 集成，适合企业级数据分析。

13. 选择图表类型（分析选择依据）

    p 216

    - **分析选择依据**
      - **数据类型：** 分类数据、数值数据、时间序列数据。
      - **可视化目标：** 比较、趋势、分布、关系。
      - **受众：** 不同的受众对图表的理解程度不同。
    - **常见图表类型及其适用场景：**
      - **柱状图：** 比较不同类别的数据。
      - **折线图：** 展示数据随时间变化的趋势。
      - **饼图：** 展示各部分占总体的比例。
      - **散点图：** 展示两个变量之间的关系。
      - **箱线图：** 展示数据的分布情况。

14. python 程序绘制图表

    p 221

    需要掌握 Matplotlib 或 Seaborn 的基本用法，能够绘制常见的图表类型，例如折线图、柱状图、散点图等。

15. 超市各门店的每日销售数据汇总到 HDFS 中存储。请说明这些销售数据属于哪种数据来源类型？结构化数据（或关系型数据）

    - 超市销售数据属于**结构化数据**（或关系型数据），通常存储在关系型数据库中。

16. 设计一种适合该场景的低频率增量采集方法。

    p 67

    - **定义：**只采集新增或发生变化的数据，而不是全量采集。
    - **设计方法：**
      1. **时间戳：** 记录上次采集的时间戳，只采集时间戳之后的数据。
      2. **版本号：** 记录数据的版本号，只采集版本号发生变化的数据。
      3. **触发器：** 在数据发生变化时，触发采集程序。

17. 针对字段商品 `名称_销量`（示例：`上衣_20`），应使用什么预处理操作将其拆分为商品名称和销量两个独立字段？在 Python pandas 中的核心函数名。

    - **字段拆分（或字符串分割）**：Pandas 函数：`str.split()`
    - 配合 `expand=True`（如 `df['商品名称_销量"].str.split('_', expand=True)`）

## 原题

1. 根据“绿能智慧”共享单车公司的需求，该公司如何利用大数据技术采集到大量的用户数据？并分析采集到的大数据有什么特点？为什么这些大数据对于公司利用大数据优化产品和服务非常重要？在收集用户大数据的过程中会遇到哪些困难，应该遵守的大数据伦理是什么？
2. 在大数据采集时，源数据往往存在很多脏数据，哪些数据属于脏数据？假如收集的学生学习时长数据有很多缺失值，若要用均值填充法填充这些缺失值，有什么利弊？如果学生的姓名字段值存在部分全为空格的记录，分析产生的原因，并给出数据预处理办法。
3. 若学生考试成绩数据集存在异常值，请利用 Python 编写一段程序，找出《计算机原理》课程成绩（score）中小于 0 或大于 100 的异常数据，并将这些学生的《计算机原理》课程等级（grade）字段值设置为缺失值（NaN），最后输出处理后的数据。
4. 数据可视化的流程是什么？数据可视化常用的工具有哪些？常见的数据可视化图表有哪些？并简述各种图表的特点和使用场景。
5. 某交通局收集了各大主干道车辆通行记录、路口监控视频、共享单车使用数据等在内的多源交通信息，交通局希望将复杂的交通数据转化为直观的图表，以精准识别交通拥堵规律。该局应该选择哪些可视化图表比较合适，并说明选择这些图表依据。
6. 为城市环保局推荐数据可视化常用的工具，说明工具的特点。
7. 例如，"S0000123, HUAWE P10, ST003, 2023-05-10, 4.5" 这样的销售数据属于什么类型的数据（结构化数据？还是非结构化数据？）华为手机各门店的销售数据如何能够以一种低频率增量采集方法快速收集并汇总？
8. 分析“水果类商品在 2024 年 Q3 的销量趋势”，可选择哪种基础图表类型？说明选择理由。
9. 使用什么预处理操作能拆分一个字段为两个独立的字段，比如把“商品名称_销量”这个字段拆分为“商品名称”和“销量”2 个字段？并写出用到的 Python pandas 中的核心函数是什么？
10. 大数据思维的三个核心特征是什么？其和传统数据分析的区别是什么？
